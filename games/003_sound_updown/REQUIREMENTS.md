# 要件定義書: 003_sound_updown (おと・アップダウン)

## 1. ゲーム概要
*   **タイトル**: おと・アップダウン (Sound UpDown)
*   **コンセプト**: 「今の音より、高い？低い？」を直感的に当てる、スピード感のある音感トレーニングゲーム。
*   **ターゲット**: 1歳〜大人（特に2歳児が適当に触っても楽しめる設計）。
*   **目的**: 相対的な音の高さ（ピッチの上下）を聞き分ける能力を養う。

## 2. ゲームプレイ仕様

### 2.1. 基本ルール
1.  **出題**: 連続して2つの音が鳴る。「音1（基準）」→「音2（比較対象）」。
2.  **回答**: 音2が音1より**高い**か**低い**かを判断し、画面の上下をタップする。
    *   高い → 画面上半分（Highエリア）をタップ
    *   低い → 画面下半分（Lowエリア）をタップ
3.  **判定**:
    *   **正解**: 即座に次の問題へ移行（スピード重視）。キャラクターがアクションを行う（階段を登る/降りる）。コンボ数が加算される。
    *   **不正解**: エラー音が鳴り、正解するまで進行しない（ペナルティなし、リトライ待ち）。コンボ数が0にリセットされる。
4.  **連鎖（しりとり形式）**:
    *   正解すると、今回の「音2」が次の問題の「音1（基準）」となる。
    *   これにより、回答するたびにメロディのように音が繋がっていく。
5.  **コンボシステム**:
    *   **動的難易度**: コンボが続くほど、選択中のレベルに関わらず難易度（音程差）が上昇する（最大Lv30相当まで）。コンボが途切れると元の難易度に戻る。
    *   **スコアボーナス**: コンボ数に応じて、正解時の獲得スコアが増加する。
    *   **演出**: 10コンボごとに派手な視覚エフェクトとテキストを表示する。

### 2.2. レベルデザイン（難易度調整）
*   **Lv1〜**:
    *   音程差：**1オクターブ以上**（非常に分かりやすい）。
    *   音色：動物の声やコミカルな音。
    *   視覚補助：正解エリアが**プレイ中常に点滅・強調**される（「光っている方を押す」だけで遊べる）。
*   **Lv15〜**:
    *   音程差：**3度〜5度**（ドミソの範囲）。
    *   音色：ピアノなどの楽器音。
    *   視覚補助：**なし**（正解後のみエフェクト）。耳で判断する。
*   **Lv30〜**:
    *   音程差：**半音〜全音**（ドとド#など）。難易度高。
    *   音色：楽器音。
    *   視覚補助：なし。

### 2.3. 2歳児向けUX（ユーザー体験）
*   **全画面ボタン**: 画面を上下2分割し、細かいボタン操作を不要にする。
*   **フィードバック**:
    *   上エリアタップ時：「高いキラキラ音」＋視覚エフェクト（空、鳥など）。
    *   下エリアタップ時：「低いドスン音」＋視覚エフェクト（海、泡など）。
    *   不正解でもこれらの反応を返し、「触ると反応するおもちゃ」としての楽しさを保証する。
*   **ゲームオーバーなし**: 制限時間制だが、失敗による途中終了はなし。

## 3. 画面構成
1.  **プレイ画面**:
    *   **上半分エリア**: 「たかい！」（背景：空/赤系）。タップ領域。
    *   **下半分エリア**: 「ひくい！」（背景：海/青系）。タップ領域。
    *   **中央**: キャラクター（カエルなど）と、現在の「段数（スコア）」表示。
    *   **上部**: 制限時間タイマー。
2.  **結果画面**:
    *   最終スコア（到達段数）。
    *   リーダーボード（ランキング）表示。
    *   「もういちど」ボタン。

## 4. 技術要件
*   **音声再生**: Web Audio APIを使用。遅延なく連続再生できること。
    *   002の `Config.InstrumentSamples` を流用、または単純なオシレーター（Sine, Square）や動物音源を使用。
*   **データ保存**:
    *   `localStorage` にハイスコア、選択レベルを保存。
    *   AWS APIへのスコア送信（既存の `Config.API_ENDPOINT` 利用）。
*   **制限事項**:
    *   `ui-lock.js` を適用（拡大縮小禁止、マルチタッチ無効、コンテキストメニュー禁止）。

## 5. ファイル構成案
`games/003_sound_updown/`
├── `game.json` (メタデータ)
├── `index.html` (ゲーム画面兼レベル選択)
├── `game.js` (ゲームロジック)
├── `style.css` (固有スタイル)
└── `REQUIREMENTS.md` (本ファイル)
