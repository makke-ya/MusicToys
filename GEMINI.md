# GEMINI.md - 開発ガイドライン for AI

## 1. はじめに
- このドキュメントは、AI開発エージェントが本プロジェクトで開発を行うためのガイドラインです。
- **AIによるファイル操作について: ファイルの作成やディレクトリの作成はユーザーの許可なく実施しますが、ファイルの移動や削除を行う際は、事前にユーザーの許可を求めます。**
- このプロジェクトは、1歳〜6歳のお子様（幼児）を主要なターゲットユーザーとして開発を進めます。
- AIとの対話は、原則として日本語で行います。

## 2. 基本方針
- **開発プロセス**: テスト駆動開発 (TDD) を基本とします。
- **承認プロセス**: ユーザーからの明示的な合図（「TDDを開始してください」等）があるまで、実装（コーディング）を開始してはいけません。
- **設計思想**: 保守性と拡張性を高めるため、SOLID原則を意識して設計してください。
- **ディレクトリ構造**: `docs/GAME_ARCHITECTURE.md` の定義に従ってください。
- **ライブラリ**: 既存ライブラリ (Vue.js, TailwindCSS) を活用し、新規追加はCDN経由とします。
- **バージョン管理**: コミットメッセージは [Conventional Commits](https://www.conventionalcommits.org/ja/v1.0.0/) に準拠します。
- **パス解決**: すべてのリソースパスは、サイトルートからの絶対パス (`/`) を使用してください。

## 3. 新しいゲームの追加方法
1. **ディレクトリ作成**: `games/` 配下に `000_game_name` 形式で専用ディレクトリを作成します。
2. **`game.json` の配置**: 作成したディレクトリに、以下の形式で `game.json` を配置します。
   ```json
   {
     "name": "ゲーム名",
     "description": "ゲームの説明",
     "entry_point": "start.html",
     "thumbnail": "images/thumbnail.png"
   }
   ```
3. **ランチャーへの登録**: ルートの `index.html` 内の `gameDirectories` 配列に、作成したディレクトリ名を追加します。

## 4. コーディング規約
- **JavaScript**:
    - インラインスクリプトは禁止し、外部ファイルに分離してください。
    - グローバルスコープの汚染を避けてください。
- **HTML**:
    - `<div>`ばかりに頼らず、意味論的なタグ (`h1`, `button` 等) を使用してください。
- **CSS**:
    - スタイリングはTailwindCSSを優先し、必要に応じて共通またはゲーム固有のCSSファイルに記述してください。

## 5. テストガイドライン

### 5.1 テスト駆動開発 (TDD) の実践
本プロジェクトでは、TDD（テスト駆動開発）を基本とし、「Red → Green → Refactor」のサイクルを徹底します。
1.  **Red (失敗するテストを書く)**: まず、これから実装する機能の最小単位で、必ず失敗するテストコードを書きます。
2.  **Green (テストを成功させる最小限のコードを書く)**: Redになったテストを成功させるため、必要最低限のアプリケーションコードを実装します。この段階では、設計の美しさや効率は問いません。
3.  **Refactor (コードをリファクタリングする)**: テストがすべてGreenになったら、アプリケーションコードをリファクタリングし、品質を向上させます。リファクタリング後もテストがGreenであることを確認します。

### 5.2 テストの種類と実行方法

テストコードは、以下のディレクトリに配置し、それぞれのショートカットコマンドで実行します。

*   **単体テスト (Unit Tests)**
    *   **対象**: 個々の関数、コンポーネントなどの最小単位のロジック
    *   **フレームワーク**: Jest
    *   **配置場所**: `__tests__/` ディレクトリ
    *   **実行コマンド**: 
        *   `npm test`: 全ての単体テストを実行します。
        *   `npm run testw` (`npm run test:watch`): ファイルの変更を監視し、関連する単体テストを自動で再実行します。TDDサイクルを回す際に活用してください。

*   **結合テスト (Integration Tests)**
    *   **対象**: 複数のモジュールやコンポーネントが連携して動作するフロー、UIの基本的な動作など
    *   **ツール**: Puppeteer (Chrome DevTools プロトコル経由)
    *   **配置場所**: `integration/` ディレクトリ
    *   **実行コマンド**: 
        *   `npm run testi` (`npm run test:integration`): 結合テストのみを実行します。

これらのテストを活用し、コード品質の維持と効率的な開発を目指しましょう。